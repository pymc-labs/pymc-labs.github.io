<!doctype html><html lang="en">

    <head>
        

        <style media="screen">
            body {
                padding-top: 70px;
                padding-bottom: 70px;
            }

        </style>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
            integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
        <link rel="stylesheet" href="../../static/css/custom_style.css?h=16f93eb7">
        <link rel="stylesheet" href="../../static/css/table_style.css?h=c677f945">

        <!-- Highlight.js for syntax highlighting -->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css">


        <!-- Extra meta tags: social site cards, browser icons... -->
        <meta name="theme-color" content="#ffffff">
        <link rel="shortcut icon" href="../../static/favicon.ico?h=d935d59e">
        <link rel="apple-touch-icon" sizes="180x180" href="../../static/apple-touch-icon.png?h=2bad941d">
        <link rel="icon" type="image/png" sizes="32x32" href="../../static/favicon-32x32.png?h=1673bb68">
        <link rel="icon" type="image/png" sizes="16x16" href="../../static/favicon-16x16.png?h=089e66cb">

        <title>Bayesian Vector Autoregression in PyMC - PyMC Labs</title>
        <meta name="twitter:card" content="summary">
        <meta property="og:url" content="https://pymc-labs.github.io/blog-posts/bayesian-vector-autoregression/" />
        <meta property="og:type" content="website" />
        <link rel="canonical" href="">
        <meta property="og:title" content="Bayesian Vector Autoregression in PyMC - PyMC Labs" />
        <meta property="og:description" content="It&#39;s time to let go of your custom Gibbs sampler" />
        <meta property="og:image" content="https://pymc-labs.github.io/blog-posts/bayesian-vector-autoregression/cover.png" />
        <meta name="description" content="We are a Bayesian consulting firm specializing in data analysis and predictive modeling. Contact us today to learn how we can help your business.">
        <meta name="keywords" content="Bayesian consulting, data analysis, predictive modeling">

        <!-- Highlight.js for syntax highlighting -->
        <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.0/styles/default.min.css"> -->
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.0/highlight.min.js"></script> -->
        <!-- <script>hljs.highlightAll();</script> -->

        <!-- From: https://github.com/lektor/lektor-markdown-highlighter -->
        <!-- We use this to do syntax highlighting -->
        <link rel="stylesheet" href="../../static/pygments.css">
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-F3RDLH8R8X"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-F3RDLH8R8X');
        </script>
        
<script src="../../static/scripts/toggle_code.js?h=3a00c72f" defer></script>

    </head>

    <body>
        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
            <div class="container">
                <!-- <a class="navbar-brand" href="/">PyMC Labs</a> -->
                <a class="navbar-brand" href="/"><img alt="logo" loading="eager" width="88" height="70" title="logo" class="navbar-logo"
                        src="../../static/images/pymc-labs-logo.png?h=999c3177'"></a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTop"
                    aria-controls="navbarTop" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarTop">
                    <ul class="navbar-nav ml-auto">
                        
                        <li class="nav-item">
                            <a class="nav-link" href="/what-we-do"><i class="fa fa-info-circle"
                                    aria-hidden="true"></i>
                                What we do</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="/products"><i class="fa fa-shopping-cart"
                                    aria-hidden="true"></i>
                                Products</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="/team"><i class="fa fa-user-friends"
                                    aria-hidden="true"></i>
                                Team</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="/clients"><i class="fa fa-microphone"
                                    aria-hidden="true"></i>
                                Clients</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="/workshops"><i class="fa fa-chalkboard-teacher"
                                    aria-hidden="true"></i>
                                Workshops</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="/blog-posts"><i class="fa fa-book-open"
                                    aria-hidden="true"></i>
                                Blog</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </nav>
        
        <div class="container">
            

<div class="row">
    <div class="col-md-2"></div>
    <div class="col-md-8 blogpost">
        <h2 class="font-roboto">Bayesian Vector Autoregression in PyMC</h2>
        
        <p class="mb-2 text-muted">It&#39;s time to let go of your custom Gibbs sampler</p>
        
        <hr>
        <div class="row">
            <div class="col-md-6 author_name">
                <small class="text-muted">AUTHORED BY</small>
                <p class="font-bold">
                    



    



    
        Ricardo Vieira
    



                </p>
            </div>
            <div class="col-md-6 author_date">
                <!-- <p>2022-06-24</p> -->
                
<small class="text-muted">DATE</small>
<p class="font-lighter">2022-06-24</p>

<!--<div class="cover-blogposts"><img src="../../static/images/blog_post/cover.jpg?h=653e9b57"></div>-->

            </div>
        
            
                <div class="blog-cover-container">
                    <img loading="lazy" title="cover image" alt="" class="cover-blogposts" src="cover.png">
                </div>
            
	    </div>
        <hr> <h3 id="a-little-bit-of-history">A little bit of history</h3><p>In the seminal 1993 <a href="https://apps.olin.wustl.edu/faculty/chib/papers/chib93.pdf">paper</a> "Bayes regression with autoregressive errors: A Gibbs sampling approach", Siddhartha Chib presented to economists the potential of Gibbs sampling in "realistic settings that were previously considered intractable from a Bayesian perspective".</p>
<p>A cursory reading reveals a pattern that is quite characteristic of this early type of work. A time-series statistical model is first described, usually in a handful of equations —1 in this case—, followed by an intricate analysis of how the model joint-probability can be cut into conditionally independent blocks appropriate for Gibbs sampling. In that paper this amounts to no less than 9 equations! If one's model could not be easily cut into sample-able blocks, <a href="https://rss.onlinelibrary.wiley.com/doi/pdf/10.1111/1467-9868.00179">"auxiliary" variables</a> could always be added as topping, until such cut was found.</p>
<p>As if this was not hard enough, early pioneers had to write their custom Gibbs sampling algorithms by hand, taking care to accommodate the existing computing limitations. Chib's paper makes mention of a powerful 33MHz machine. This process was somewhat alleviated by increasing compute power and by the advent of general purpose MCMC samplers like <a href="https://en.wikipedia.org/wiki/WinBUGS">BUGS</a> and <a href="https://en.wikipedia.org/wiki/Just_another_Gibbs_sampler">JAGS</a>, and later more powerful Hamiltonian Monte Carlo samplers like those found in <a href="https://mc-stan.org/users/documentation/">Stan</a> and <a href="https://docs.pymc.io">PyMC</a>.</p>
<p>Surprisingly, many are still relying on custom Gibbs sampler algorithms to <a href="https://twitter.com/twiecki/status/1500119140660658180">this day</a>. Perhaps begging their joint probabilities to factor nicely or chasing the auxiliary variables needed for their latest model ideas. Needless to say, with PyMC, we won't be doing any of this!</p>
<h3 id="back-to-the-present">Back to the present</h3><p>We will implement a Vector Autoregression (VAR) model, a powerful time series tool, to examine and forecast complex dynamic relationships between variables. VAR models are routinely used by most macroeconomic and policy-making institutions, and have been increasingly adopted in other areas. Some interesting applications include:</p>
<table>
<thead><tr>
<th>Model subject</th>
<th>Field</th>
<th>Publications</th>
</tr>
</thead>
<tbody>
<tr>
<td>Individual patient health from digital records</td>
<td>Medicine</td>
<td><a href="https://ieeexplore.ieee.org/abstract/document/7038195">A</a>, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5161241/">B</a></td>
</tr>
<tr>
<td>Behavioral activitity recognition from sensor data</td>
<td>Machine Classification</td>
<td><a href="https://ieeexplore.ieee.org/abstract/document/8614179">C</a></td>
</tr>
<tr>
<td>COVID risk interactions across age groups</td>
<td>Epidemiology</td>
<td><a href="https://www.mdpi.com/1660-4601/17/14/5246">D</a></td>
</tr>
<tr>
<td>Gene expression regulatory networks</td>
<td>Biology</td>
<td><a href="https://bmcsystbiol.biomedcentral.com/articles/10.1186/1752-0509-1-39">E</a></td>
</tr>
<tr>
<td>Supply and demand of IT devices</td>
<td>Business</td>
<td><a href="https://pubsonline.informs.org/doi/abs/10.1287/isre.1120.0418">F</a></td>
</tr>
<tr>
<td>Short-term changes in solar and wind power</td>
<td>Energy</td>
<td><a href="https://ieeexplore.ieee.org/abstract/document/7105918">G</a>, <a href="https://ieeexplore.ieee.org/abstract/document/9026330">H</a></td>
</tr>
<tr>
<td>National and city level pollution</td>
<td>Environment</td>
<td><a href="https://www.sciencedirect.com/science/article/abs/pii/S0959652616304176">I</a>, <a href="https://www.sciencedirect.com/science/article/abs/pii/S0360544218304602">J</a>, <a href="https://ejournal.upi.edu/index.php/ijost/article/view/32732">K</a></td>
</tr>
<tr>
<td>Exchange rate and inflation</td>
<td>Economics</td>
<td><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1538-4616.2008.00165.x">L</a></td>
</tr>
<tr>
<td>Economic effects of oil price shocks</td>
<td>Economics</td>
<td><a href="https://www.sciencedirect.com/science/article/pii/S104900781630224X">M</a></td>
</tr>
</tbody>
</table>
<p><span></span></p>
<p>To understand how VAR works, it helps to first take a brief look at the simpler Autoregression models.</p>
<h2 id="autoregression-models">Autoregression models</h2><p>Autoregression models (AR) try to predict current observations as a linear combination of the past observations.</p>
<p>Assuming that the most recent $n$ values influence the current observation, the model is described by the following equation:</p>
<p><span>
$$y_t = \text{intercept} + \text{coef}_1 \cdot y_{t-1} + \text{coef}_2 \cdot y_{t-2} + \ldots + \text{coef}_n \cdot y_{t-n} + \epsilon$$
</span></p>
<p>Simulating data from an AR process is quite simple:</p>
<div class="hll"><pre><span></span><span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">az</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;arviz-darkgrid&quot;</span><span class="p">)</span>
<span class="n">seed</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">ord</span><span class="p">,</span> <span class="s2">&quot;PyMC LABS - BVAR&quot;</span><span class="p">))</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</pre></div>
<div class="hll"><pre><span></span><span class="k">def</span> <span class="nf">simulate_ar</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span> <span class="n">coef1</span><span class="p">,</span> <span class="n">coef2</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">warmup</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>   
    <span class="c1"># We sample some extra warmup steps, to let the AR process stabilize</span>
    <span class="n">draws</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">warmup</span><span class="o">+</span><span class="n">steps</span><span class="p">)</span>
    <span class="c1"># Initialize first draws at intercept</span>
    <span class="n">draws</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">intercept</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">warmup</span><span class="o">+</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">draws</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">intercept</span> 
            <span class="o">+</span> <span class="n">coef1</span> <span class="o">*</span> <span class="n">draws</span><span class="p">[</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">coef2</span> <span class="o">*</span> <span class="n">draws</span><span class="p">[</span><span class="n">step</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="c1"># Discard the warmup draws</span>
    <span class="k">return</span> <span class="n">draws</span><span class="p">[</span><span class="n">warmup</span><span class="p">:]</span>
</pre></div>
<p>In this first example, new values for $y$ at time $t$ depend only on the intercept and the previous value $y_{t-1}$. This would be an autoregression model of first order or AR(1).</p>
<div class="hll"><pre><span></span><span class="n">ar1</span> <span class="o">=</span> <span class="n">simulate_ar</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ar1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$y_t = 18 - 0.8y_{t-1}$&quot;</span><span class="p">);</span>
</pre></div>
<p><img src="output_5_0.png" alt="png"></p>
<p>In an AR(2), new values are influenced by the two preceding values.</p>
<div class="hll"><pre><span></span><span class="n">ar2</span> <span class="o">=</span> <span class="n">simulate_ar</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ar2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$x_t = 8 + 1.3y_{t-1} - 0.7y_{t-2}$&quot;</span><span class="p">);</span>
</pre></div>
<p><img src="output_7_0.png" alt="png"></p>
<p>As the order of an AR model increases, so does the range of temporal dependencies and the richness of patterns that can be captured. On the other hand, the effect of each coefficient will be harder to determine, as each one plays a proportionally smaller role in the model outcomes.</p>
<h2 id="vector-autoregression-models">Vector Autoregression models</h2><p>Vector autoregression models (VAR) are the multivariate generalization of AR. In a similar vein, they assume that a set of variables, observed at time $t$, can be well predicted by a linear combination of the previous observations of that same set of variables.</p>
<p>Assuming that only the most recent two values have an effect on the current observations, the VAR(2) model is described by:</p>
<p><span>
$$
y_t = \text{intercept}_x + \text{coef}yy_1 \cdot y_{t-1} + \text{coef}yy_2 \cdot y_{t-2} + \text{coef}xy_1 \cdot x_{t-1} + \text{coef}xy_2 \cdot x_{t-2} + \epsilon_y \\
x_t = \text{intercept}_y + \text{coef}yx_1 \cdot y_{t-1} + \text{coef}yx_2 \cdot y_{t-2} + \text{coef}xx_1 \cdot x_{t-1} + \text{coef}xx_2 \cdot x_{t-2} + \epsilon_x
$$
</span></p>
<p>This type of model allows for bidirectional effects among variables. The current values of $y$ are not only affected by its past values, but also by the past values of $x$. In addition, the past values of $y$ also affect the current values of $x$. This type of bidirectional effects make VAR models extremely flexible and powerful.</p>
<p>Let us simulate data from a VAR(2) model:</p>
<div class="hll"><pre><span></span><span class="k">def</span> <span class="nf">simulate_var</span><span class="p">(</span><span class="n">intercepts</span><span class="p">,</span> <span class="n">coefs_yy</span><span class="p">,</span> <span class="n">coefs_xy</span><span class="p">,</span> <span class="n">coefs_xx</span><span class="p">,</span> <span class="n">coefs_yx</span><span class="p">,</span> <span class="n">noises</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">*</span><span class="p">,</span> <span class="n">warmup</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">draws_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">warmup</span><span class="o">+</span><span class="n">steps</span><span class="p">)</span>
    <span class="n">draws_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">warmup</span><span class="o">+</span><span class="n">steps</span><span class="p">)</span>
    <span class="n">draws_y</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">intercepts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">draws_x</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">intercepts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">warmup</span><span class="o">+</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">draws_y</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">intercepts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">coefs_yy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">draws_y</span><span class="p">[</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">coefs_yy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">draws_y</span><span class="p">[</span><span class="n">step</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">coefs_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">draws_x</span><span class="p">[</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">coefs_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">draws_x</span><span class="p">[</span><span class="n">step</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">noises</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="n">draws_x</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">intercepts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">coefs_xx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">draws_x</span><span class="p">[</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">coefs_xx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">draws_x</span><span class="p">[</span><span class="n">step</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">coefs_yx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">draws_y</span><span class="p">[</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">coefs_yx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">draws_y</span><span class="p">[</span><span class="n">step</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">noises</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">draws_y</span><span class="p">[</span><span class="n">warmup</span><span class="p">:],</span> <span class="n">draws_x</span><span class="p">[</span><span class="n">warmup</span><span class="p">:]</span>
</pre></div>
<div class="hll"><pre><span></span><span class="n">var_y</span><span class="p">,</span> <span class="n">var_x</span> <span class="o">=</span> <span class="n">simulate_var</span><span class="p">(</span>
    <span class="n">intercepts</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">coefs_yy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">coefs_xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">coefs_xx</span><span class="o">=</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">),</span>
    <span class="n">coefs_yx</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_y</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$y_t = 18 - 0.8y_{t-1} + 0.9x_{t-1}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$x_t = 8 + 1.3x_{t-1} - 0.7x_{t-2} - 0.1y_{t-1} + 0.3y_{t-2}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">);</span>
</pre></div>
<p><img src="output_11_0.png" alt="png"></p>
<p>Unlike the simulations in the previous section, the two time-series of $y$ and $x$ are now interdependent. Concretely, <span>$y_t$</span> depends on <span>$x_{t-1}$</span> and <span>$x_t$</span> depends on both <span>$y_{t-1}$</span> and <span>$y_{t-2}$</span>. If the coefficients for the cross-effects were all set to zero, these effects would vanish and we would be observing two independent AR processes just like before.</p>
<h2 id="going-bayesian-with-bvar">Going Bayesian with BVAR</h2><p>Bayesian Vector Autoregression models (BVAR), are the Bayesian interpretation of vanilla VAR models. Parameter uncertainty is explicitly modeled and updated via the Bayesian rule, conditioned on observed data. Like most Bayesian models, there are no hidden assumptions or special conditions under which a statistical model can or cannot be used. What you <del>see</del> write is what you get.</p>
<p>This single letter difference gives a lot of power to BVAR models. Model parameters can be directly constrained by expert information. Relevant information from different datasets can be pooled together via hierarchical modelling. Different assumptions about the extent of lagged effects or noise terms can be easily changed and contrasted. It is also quite simple to extend and combine BVAR with other types of models. As with most Bayesian tools, imagination is the only limitation.</p>
<p>Well, that and compute time...</p>
<p><img src="liveforever.webp" alt="webp"></p>
<h3 id="var-pymc-bvar">VAR + PyMC = BVAR</h3><p>The good news is that if you are using PyMC, your VAR model is necessarily a BVAR model! Let's see how easy it is to do it:</p>
<p>To honor the economic tradition of VARs, we will look at U.S. macroeconomic data for our example, and model <em>GDP growth</em> and <em>Term spread</em> between long- and short-term Treasury bonds. If you have no idea what that means... you are probably not an economist. Neither am I, so do not worry!</p>
<p>This analysis is heavily inspired by this <a href="https://www.econometrics-with-r.org/16.1-vector-autoregressions.html">chapter of Introduction to Econometrics with R</a>. Another useful reading can be found in the respective <a href="https://otexts.com/fpp3/VAR.html">chapter of Forecasting: Principles and Practice</a>.</p>
<p>Per usual, we must start with some scraping and data transformation...</p>
<div class="hll"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
<div class="hll"><pre><span></span><span class="c1"># 100% HDI that this link will go stale in the next 6 months = (0, 1)</span>
<span class="n">link</span> <span class="o">=</span> <span class="s2">&quot;https://www.princeton.edu/~mwatson/Stock-Watson_3u/Students/EE_Datasets/us_macro_quarterly.xlsx&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0&#39;</span><span class="p">},</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:01&quot;</span><span class="p">,</span> <span class="s2">&quot;-01-01&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:02&quot;</span><span class="p">,</span> <span class="s2">&quot;-04-01&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:03&quot;</span><span class="p">,</span> <span class="s2">&quot;-07-01&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:04&quot;</span><span class="p">,</span> <span class="s2">&quot;-10-01&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;GDPC96&quot;</span><span class="p">:</span> <span class="s2">&quot;GDP&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;GDP&quot;</span><span class="p">,</span> <span class="s2">&quot;GS10&quot;</span><span class="p">,</span> <span class="s2">&quot;TB3MS&quot;</span><span class="p">]]</span>
<span class="c1"># This is an approximation of the annual growth rate</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;GDPGrowth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">400</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;GDP&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;GDP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span>
<span class="c1"># Term spread as the difference between 10-year and 3-month U.S. Treasury bonds</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;TSpread&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;GS10&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;TB3MS&quot;</span><span class="p">]</span> 
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;1981&quot;</span><span class="p">:]</span>
<span class="n">df</span>
</pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GDP</th>
      <th>GS10</th>
      <th>TB3MS</th>
      <th>GDPGrowth</th>
      <th>TSpread</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1981-01-01</th>
      <td>6628.634</td>
      <td>12.960000</td>
      <td>14.390000</td>
      <td>8.200270</td>
      <td>-1.430000</td>
    </tr>
    <tr>
      <th>1981-04-01</th>
      <td>6580.199</td>
      <td>13.750000</td>
      <td>14.906667</td>
      <td>-2.933505</td>
      <td>-1.156667</td>
    </tr>
    <tr>
      <th>1981-07-01</th>
      <td>6655.692</td>
      <td>14.846667</td>
      <td>15.053333</td>
      <td>4.562976</td>
      <td>-0.206667</td>
    </tr>
    <tr>
      <th>1981-10-01</th>
      <td>6578.035</td>
      <td>14.086667</td>
      <td>11.750000</td>
      <td>-4.694544</td>
      <td>2.336667</td>
    </tr>
    <tr>
      <th>1982-01-01</th>
      <td>6468.003</td>
      <td>14.293333</td>
      <td>12.813333</td>
      <td>-6.747465</td>
      <td>1.480000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012-10-01</th>
      <td>15539.628</td>
      <td>1.706667</td>
      <td>0.086667</td>
      <td>0.145281</td>
      <td>1.620000</td>
    </tr>
    <tr>
      <th>2013-01-01</th>
      <td>15583.948</td>
      <td>1.950000</td>
      <td>0.086667</td>
      <td>1.139201</td>
      <td>1.863333</td>
    </tr>
    <tr>
      <th>2013-04-01</th>
      <td>15679.677</td>
      <td>1.996667</td>
      <td>0.050000</td>
      <td>2.449602</td>
      <td>1.946667</td>
    </tr>
    <tr>
      <th>2013-07-01</th>
      <td>15839.347</td>
      <td>2.710000</td>
      <td>0.033333</td>
      <td>4.052698</td>
      <td>2.676667</td>
    </tr>
    <tr>
      <th>2013-10-01</th>
      <td>15965.569</td>
      <td>2.746667</td>
      <td>0.063333</td>
      <td>3.174922</td>
      <td>2.683333</td>
    </tr>
  </tbody>
</table>
<p>132 rows × 5 columns</p>
</div><div class="hll"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;GDPGrowth&quot;</span><span class="p">,</span> <span class="s2">&quot;TSpread&quot;</span><span class="p">]][:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;GDPGrowth&quot;</span><span class="p">,</span> <span class="s2">&quot;TSpread&quot;</span><span class="p">]][</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">test_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
<pre><code>((122, 2), (10, 2))
</code></pre>

            <p>
                <button class="btn btn-primary btn-code-toggle collapsed" type="button" data-toggle="collapse" data-target="#collapseibleCode16" aria-expanded="false" aria-controls="collapseibleCode16">
                    Toggle code
                </button>
            </p>
            <div id="collapseibleCode16" class="collapse">
                <div class="hll"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ColorConverter</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="s2">&quot;C1&quot;</span><span class="p">)</span>

<span class="n">dark</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;C0&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="mf">.35</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ColorConverter</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s2">&quot;C0&quot;</span><span class="p">))),</span>
    <span class="s2">&quot;C1&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="mf">.35</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ColorConverter</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s2">&quot;C1&quot;</span><span class="p">))),</span>
<span class="p">}</span>
</pre></div>

            </div>
            <div class="hll"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;GDPGrowth&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">dark</span><span class="p">[</span><span class="s2">&quot;C0&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s2">&quot;GDPGrowth&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;quarterly change&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;GDP growth&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TSpread&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">dark</span><span class="p">[</span><span class="s2">&quot;C1&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s2">&quot;TSpread&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;quarterly change&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Term spread&quot;</span><span class="p">);</span>

<span class="k">for</span> <span class="n">axi</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
<p><img src="output_18_0.png" alt="png"></p>
<p>Time to model! We will consider a simple BVAR model of second order.</p>
<div class="hll"><pre><span></span><span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="nn">pm</span>
</pre></div>
<div class="hll"><pre><span></span><span class="n">lags</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">coords</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">lags</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
    <span class="s2">&quot;vars&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;GDPGrowth&quot;</span><span class="p">,</span> <span class="s2">&quot;TSpread&quot;</span><span class="p">),</span>
    <span class="s2">&quot;cross_vars&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;GDPGrowth&quot;</span><span class="p">,</span> <span class="s2">&quot;TSpread&quot;</span><span class="p">),</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">lags</span><span class="p">),</span>
<span class="p">}</span>

<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span> <span class="k">as</span> <span class="n">BVAR_model</span><span class="p">:</span>
    <span class="c1"># The first B bit:</span>
    <span class="c1"># Priors for the model intercept, lagged coefficients and noise terms</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;intercept&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;vars&quot;</span><span class="p">,))</span>
    <span class="n">lag_coefs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;lag_coefs&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lags&quot;</span><span class="p">,</span> <span class="s2">&quot;vars&quot;</span><span class="p">,</span> <span class="s2">&quot;cross_vars&quot;</span><span class="p">))</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="s2">&quot;noise&quot;</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;vars&quot;</span><span class="p">,))</span>

    <span class="c1"># The VAR bit:</span>
    <span class="c1"># Compute autoregressive expectation for each variable</span>
    <span class="c1"># We convolve the lagged coefficients of each variable with the whole dataset</span>
    <span class="n">ar_GDPGrowth</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lag_coefs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">lags</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>
    <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>        
    <span class="n">ar_TSpread</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span>
        <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lag_coefs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">lags</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>
    <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   

    <span class="c1"># Stack autoregressive terms and add intercepts</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">ar_GDPGrowth</span><span class="p">,</span> <span class="n">ar_TSpread</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># The second B bit:</span>
    <span class="c1"># For modelling simplicity, we ignore the first observations, where we could</span>
    <span class="c1"># not observe the effects of all the lagged coefficients</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;obs&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">lags</span><span class="p">:],</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;vars&quot;</span><span class="p">))</span>
</pre></div>
<div class="hll"><pre><span></span><span class="n">pm</span><span class="o">.</span><span class="n">model_to_graphviz</span><span class="p">(</span><span class="n">BVAR_model</span><span class="p">)</span>
</pre></div>
<p><img src="output_22_0.svg" alt="svg"></p>
<div class="hll"><pre><span></span><span class="k">with</span> <span class="n">BVAR_model</span><span class="p">:</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
</pre></div>
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [intercept, lag_coefs, noise]
</code></pre>
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style><div>
  <progress value='8000' class='' max='8000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [8000/8000 00:16<00:00 Sampling 4 chains, 0 divergences]
</div><pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 17 seconds.
</code></pre>
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style><div class="hll"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">);</span>
</pre></div>
<p><img src="output_26_0.png" alt="png"></p>
<h3 id="shall-we-do-some-armchair-economics">Shall we do some armchair economics?</h3><p>Sampling seems to have gone well, let's look at the results:</p>
<div class="hll"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;intercept&quot;</span><span class="p">,</span> <span class="s2">&quot;lag_coefs&quot;</span><span class="p">],</span> <span class="n">combined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">textsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Posterior 94% HDI&quot;</span><span class="p">);</span>
</pre></div>
<p><img src="output_28_0.png" alt="png"></p>
<p>We can see GDP growth is positively correlated with growth in the two preceding quarters, <code>[-1, GDPGrowth, GDPGrowth]</code> and <code>[-2, GDPGrowth, GDPGrowth]</code>, as the posteriors of both coefficients are positive and far from zero.</p>
<p>Term spread is strongly correlated with the term spread of the past quarter <code>[-1, Tspread, Tspread]</code> and slightly negatively correlated with that of two quarters past <code>[-2, TSpread, TSpread]</code>.</p>
<p>Now for the interesting part of VAR, we want to look at the cross-effects from one variable to the other. The model suggests past Term spreads may be strongly related to  GDP growth, with <code>[-1, GDPGrowth, TSpread]</code>, <code>[-2, GDPGrowth, TSpread]</code> having an absolute large mean. However, the uncertainty around these parameters is rather large.</p>
<p>In contrast, there seems to be almost no effect in the other direction, from GDP growth to term spread <code>[-1, TSpread, GDPGrowth]</code>, <code>[-2, TSpread, GDPGrowth]</code>, with posteriors of the coefficients confidently close to zero.</p>
<h3 id="easier-to-forecast">Easier to forecast</h3><p><img src="flyingmoney.webp" alt="webp"></p>
<p>Looking at numbers can only be so useful. What do they imply? Let's build a helper function to forecast future GDP growth and Term spread, according to our freshly inferred posterior parameters.</p>

            <p>
                <button class="btn btn-primary btn-code-toggle collapsed" type="button" data-toggle="collapse" data-target="#collapseibleCode17" aria-expanded="false" aria-controls="collapseibleCode17">
                    Toggle code
                </button>
            </p>
            <div id="collapseibleCode17" class="collapse">
                <div class="hll"><pre><span></span><span class="c1"># Function that takes a single draw of parameters and forecasts n steps</span>
<span class="k">def</span> <span class="nf">_forecast</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span> <span class="n">lag_coefs</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">forecast</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">len_data</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">new_draws</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">forecast</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="c1"># Fill the new array with the observed data</span>
    <span class="n">new_draws</span><span class="p">[:</span><span class="n">len_data</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">forecast</span><span class="p">):</span>
        <span class="n">ar_GDPGrowth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lag_coefs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">new_draws</span><span class="p">[</span><span class="n">len_data</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="n">lags</span><span class="p">:</span> <span class="n">len_data</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
        <span class="n">ar_TSpread</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lag_coefs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">new_draws</span><span class="p">[</span><span class="n">len_data</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="n">lags</span><span class="p">:</span> <span class="n">len_data</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">ar_GDPGrowth</span><span class="p">,</span> <span class="n">ar_TSpread</span><span class="p">])</span>
        <span class="n">new_draws</span><span class="p">[</span><span class="n">len_data</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>
    <span class="c1"># Replace all observed data with nan, so they don&#39;t show when we plot it</span>
    <span class="n">new_draws</span><span class="p">[:</span><span class="o">-</span><span class="n">forecast</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="n">new_draws</span>

<span class="c1"># Vectorized forecast function to handle multiple parameter draws</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span>
    <span class="n">_forecast</span><span class="p">,</span>
    <span class="n">signature</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;(v),(l,v,v),(v)-&gt;(o,v)&quot;</span><span class="p">),</span>
    <span class="n">excluded</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;forecast&quot;</span><span class="p">,),</span>
<span class="p">)</span>
</pre></div>

            </div>
            <div class="hll"><pre><span></span><span class="c1"># Take a random subset of 100 draws from the posterior</span>
<span class="n">draws</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">post</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;chain&quot;</span><span class="p">,</span> <span class="s2">&quot;draw&quot;</span><span class="p">))</span>
<span class="n">intercept_draws</span> <span class="o">=</span> <span class="n">post</span><span class="p">[</span><span class="s2">&quot;intercept&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">draws</span><span class="p">]</span>

<span class="n">lag_coefs_draws</span> <span class="o">=</span> <span class="n">post</span><span class="p">[</span><span class="s2">&quot;lag_coefs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">draws</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="n">lag_coefs_draws</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">lag_coefs_draws</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">noise_draws</span> <span class="o">=</span> <span class="n">post</span><span class="p">[</span><span class="s2">&quot;noise&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">draws</span><span class="p">]</span>

<span class="n">intercept_draws</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">lag_coefs_draws</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">noise_draws</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
<pre><code>((100, 2), (100, 2, 2, 2), (100, 2))
</code></pre>
<div class="hll"><pre><span></span><span class="c1"># Forecast 10 quarters into the future</span>
<span class="n">ppc_draws</span> <span class="o">=</span> <span class="n">forecast</span><span class="p">(</span><span class="n">intercept_draws</span><span class="p">,</span> <span class="n">lag_coefs_draws</span><span class="p">,</span> <span class="n">noise_draws</span><span class="p">,</span> <span class="n">forecast</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ppc_draws</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">ppc_draws</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
<div class="hll"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;GDP Growth (rescaled)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ppc_draws</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;GDPGrowth&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;observed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;forecast&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Term spread&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ppc_draws</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;TSpread&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;observed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;forecast&quot;</span><span class="p">)</span>


<span class="k">for</span> <span class="n">axi</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.4</span><span class="p">))</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;quartely change&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
<p><img src="output_33_0.png" alt="png"></p>
<p><br>
That will be all for today. We hope you enjoyed the basics of Bayesian Vector Autoregression in PyMC.
<br></p>

	<!--THIS IS THE FOOTER OF THE BLOGPSOT-->
	<hr> 
		<!--div class="container"-->
			<h2 class="font-roboto">Work with PyMC Labs</h2>
			<p>If you are interested in seeing what we at PyMC Labs can do for you, then please email <a href="mailto:info@pymc-labs.com">info@pymc-labs.com</a>. We work with companies at a variety of scales and with varying levels of existing modeling capacity.

We also run <a href="https://www.pymc-labs.com/workshops/">corporate workshop training events</a> and can provide sessions ranging from introduction to Bayes to more advanced topics.
			</p>
		<!--/div-->
    
    </div>
    <div class="col-md-2"></div>
</div>


        </div>

        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
            integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
            crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
            integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
            crossorigin="anonymous"></script>
        <script src="https://kit.fontawesome.com/8cc267a9ab.js" crossorigin="anonymous"></script>

        <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-bottom">
            <div class="container">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarBottom"
                    aria-controls="navbarBottom" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarBottom">
                    <ul class="navbar-nav ml-auto">
                        
                        <li class="nav-item">
                            <a class="nav-link" href="https://twitter.com/pymc_labs"><i class="fa fa-twitter"
                                    aria-hidden="true"></i>
                                Twitter</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="https://github.com/pymc-labs"><i class="fa fa-github"
                                    aria-hidden="true"></i>
                                GitHub</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.linkedin.com/company/pymc-labs/"><i class="fa fa-linkedin"
                                    aria-hidden="true"></i>
                                LinkedIn</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.youtube.com/c/PyMCLabs"><i class="fa fa-youtube"
                                    aria-hidden="true"></i>
                                YouTube</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.meetup.com/pymc-labs-online-meetup/"><i class="fa fa-meetup"
                                    aria-hidden="true"></i>
                                Meetup</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="/newsletter"><i class="fa fa-solid fa-bell"
                                    aria-hidden="true"></i>
                                Newsletter</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="/privacy-policy"><i class="fa fa-solid fa-lock"
                                    aria-hidden="true"></i>
                                Privacy Policy</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="/impressum"><i class="fa fa-solid fa-info-circle"
                                    aria-hidden="true"></i>
                                Impressum</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="/contact"><i class="fa fa-solid fa-file-signature"
                                    aria-hidden="true"></i>
                                Contact</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </nav>

    <!-- Mathjax for latex/equations -->
    <!-- Mathjax -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
        </script>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
    </script>

    </body>

</html>
